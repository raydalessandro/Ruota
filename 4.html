<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Vinci con Vodafone</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap');
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; -webkit-touch-callout: none; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }
        :root { --vodafone-red: #E60000; --vodafone-dark: #4A0000; --vodafone-light: #FF3333; }
        body { font-family: 'Poppins', sans-serif; background: linear-gradient(135deg, #E60000 0%, #990000 50%, #660000 100%); min-height: 100vh; min-height: -webkit-fill-available; display: flex; flex-direction: column; align-items: center; justify-content: flex-start; padding: 20px; position: relative; overflow-x: hidden; overflow-y: auto; -webkit-overflow-scrolling: touch; }
        .landing-page { text-align: center; max-width: 650px; width: 100%; animation: fadeIn 0.6s ease-out; }
        .landing-logo { background: white; padding: 40px 60px; border-radius: 30px; box-shadow: 0 15px 40px rgba(0,0,0,0.3); margin-bottom: 40px; display: inline-block; }
        .landing-logo h1 { font-size: 3.5em; color: var(--vodafone-red); font-weight: 800; margin: 0; letter-spacing: -2px; }
        .landing-subtitle { font-size: 1.1em; color: #666; margin-top: 10px; font-weight: 600; }
        .welcome-message { background: rgba(255,255,255,0.98); padding: 50px 40px; border-radius: 30px; margin-bottom: 40px; box-shadow: 0 20px 60px rgba(0,0,0,0.25); border: 2px solid rgba(255,255,255,0.3); }
        .welcome-title { font-size: 2.8em; background: linear-gradient(135deg, var(--vodafone-red), var(--vodafone-dark)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-weight: 800; margin-bottom: 25px; line-height: 1.2; }
        .welcome-text { font-size: 1.3em; color: #444; line-height: 1.7; margin-bottom: 35px; font-weight: 500; }
        .benefits { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 20px; margin-bottom: 40px; }
        .benefit-item { background: linear-gradient(135deg, #FFF5F5, #FFE6E6); padding: 25px 20px; border-radius: 20px; border: 3px solid var(--vodafone-red); transition: transform 0.3s ease; }
        .benefit-item:active { transform: scale(0.95); }
        .benefit-icon { font-size: 2.5em; margin-bottom: 12px; }
        .benefit-text { font-size: 1.05em; color: var(--vodafone-red); font-weight: 700; text-align: center; }
        .play-button { background: linear-gradient(135deg, var(--vodafone-red), var(--vodafone-dark)); color: white; border: none; padding: 25px 60px; border-radius: 60px; font-size: 1.6em; font-weight: 800; cursor: pointer; transition: transform 0.2s ease; box-shadow: 0 10px 30px rgba(230,0,0,0.5); text-transform: uppercase; letter-spacing: 2px; }
        .play-button:active { transform: scale(0.95); }
        .play-button:disabled { background: linear-gradient(135deg, #999, #666); cursor: not-allowed; opacity: 0.6; }
        .cooldown-message { background: rgba(255,255,255,0.95); padding: 25px; border-radius: 20px; margin-top: 30px; border: 3px solid #FFA500; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .cooldown-title { color: var(--vodafone-red); font-size: 1.4em; font-weight: 800; margin-bottom: 15px; }
        .cooldown-text { color: #555; font-size: 1.1em; line-height: 1.6; font-weight: 600; }
        .cooldown-timer { background: linear-gradient(135deg, #FFF5F5, #FFE6E6); padding: 15px; border-radius: 15px; margin-top: 15px; border: 2px solid var(--vodafone-red); }
        .timer-label { color: #666; font-size: 0.9em; margin-bottom: 5px; }
        .timer-value { color: var(--vodafone-red); font-size: 1.8em; font-weight: 800; letter-spacing: 1px; }
        .disclaimer { margin-top: 30px; font-size: 0.9em; color: rgba(255,255,255,0.9); font-style: italic; }
        .game-page { display: none; width: 100%; max-width: 550px; animation: slideIn 0.4s ease-out; }
        .game-header { text-align: center; margin-bottom: 40px; }
        .game-logo { background: white; padding: 25px 40px; border-radius: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); margin-bottom: 20px; display: inline-block; }
        .game-logo-title { font-size: 2em; color: var(--vodafone-red); font-weight: 800; margin: 0; letter-spacing: -1px; }
        .game-title { color: white; font-size: 2.2em; margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.4); font-weight: 800; }
        .game-subtitle { color: #FFE6E6; font-size: 1.1em; text-shadow: 1px 1px 2px rgba(0,0,0,0.3); font-weight: 600; }
        .wheel-container { position: relative; width: 380px; height: 380px; margin: 30px auto; }
        .wheel-shadow { position: absolute; width: 100%; height: 100%; border-radius: 50%; background: radial-gradient(circle, rgba(0,0,0,0.3) 0%, transparent 70%); transform: translateY(10px) scale(0.9); }
        .wheel { width: 100%; height: 100%; border-radius: 50%; position: relative; overflow: visible; transition: transform 5s cubic-bezier(0.17, 0.67, 0.12, 0.99); will-change: transform; transform: translateZ(0) rotate(0deg); -webkit-transform: translateZ(0) rotate(0deg); backface-visibility: hidden; -webkit-backface-visibility: hidden; -webkit-perspective: 1000; perspective: 1000; z-index: 5; }
        .wheel-base { position: absolute; width: 100%; height: 100%; border-radius: 50%; background: linear-gradient(135deg, #FFD700 0%, #FFA500 50%, #8B6914 100%); box-shadow: 0 0 0 8px rgba(255,215,0,0.3), 0 10px 40px rgba(0,0,0,0.4); border: 6px solid #8B6914; }
        .wheel-ring { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); border-radius: 50%; pointer-events: none; }
        .wheel-ring-outer { width: 96%; height: 96%; border: 4px solid rgba(255,215,0,0.6); }
        .wheel-ring-inner { width: 30%; height: 30%; border: 3px solid rgba(139,105,20,0.8); background: linear-gradient(135deg, #FFD700, #FFA500); }
        .wheel-segments { position: absolute; width: 100%; height: 100%; top: 0; left: 0; clip-path: circle(43% at 50% 50%); }
        .segment { position: absolute; width: 50%; height: 50%; transform-origin: 100% 100%; clip-path: polygon(0 0, 100% 0, 100% 100%); display: flex; align-items: center; justify-content: center; }
        .segment:nth-child(1) { background: linear-gradient(135deg, #E60000 0%, #990000 100%); transform: rotate(0deg); }
        .segment:nth-child(2) { background: linear-gradient(135deg, #FFFFFF 0%, #CCCCCC 100%); transform: rotate(72deg); }
        .segment:nth-child(3) { background: linear-gradient(135deg, #E60000 0%, #990000 100%); transform: rotate(144deg); }
        .segment:nth-child(4) { background: linear-gradient(135deg, #FFFFFF 0%, #CCCCCC 100%); transform: rotate(216deg); }
        .segment:nth-child(5) { background: linear-gradient(135deg, #E60000 0%, #990000 100%); transform: rotate(288deg); }
        .segment-text { position: absolute; top: 25%; left: 60%; transform: rotate(36deg); font-weight: 800; font-size: 0.75em; text-align: center; line-height: 1.2; text-shadow: 1px 1px 3px rgba(0,0,0,0.5); padding: 5px; width: 80px; }
        .segment:nth-child(1) .segment-text, .segment:nth-child(3) .segment-text, .segment:nth-child(5) .segment-text { color: white; }
        .segment:nth-child(2) .segment-text, .segment:nth-child(4) .segment-text { color: var(--vodafone-red); }
        .wheel-center { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 100px; height: 100px; background: linear-gradient(135deg, #FF3333, #E60000 40%, #990000 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; z-index: 10; box-shadow: 0 6px 20px rgba(0,0,0,0.4); cursor: pointer; transition: transform 0.2s ease; border: 4px solid #FFD700; will-change: transform; }
        .wheel-center:active { transform: translate(-50%, -50%) scale(0.95); }
        .spin-button { background: transparent; color: white; border: none; border-radius: 50%; width: 100%; height: 100%; font-size: 0.9em; font-weight: 800; cursor: pointer; text-transform: uppercase; display: flex; flex-direction: column; align-items: center; justify-content: center; text-shadow: 1px 1px 3px rgba(0,0,0,0.5); }
        .spin-icon { font-size: 1.8em; margin-bottom: 5px; }
        .pointer { position: absolute; top: -45px; left: 50%; transform: translateX(-50%); z-index: 11; }
        .pointer svg { width: 50px; height: 50px; }
        .back-button { background: rgba(255,255,255,0.25); color: white; border: 3px solid white; padding: 12px 25px; border-radius: 25px; font-size: 1em; cursor: pointer; margin-top: 25px; transition: transform 0.2s ease; font-weight: 700; box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        .back-button:active { transform: scale(0.95); }
        .result-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 1000; justify-content: center; align-items: center; animation: fadeIn 0.3s ease-out; padding: 20px; overflow-y: auto; -webkit-overflow-scrolling: touch; }
        .result-content { background: linear-gradient(145deg, #FFFFFF, #FFF5F5); border-radius: 20px; padding: 25px 18px; text-align: center; max-width: 90%; width: 100%; max-height: 85vh; overflow-y: auto; animation: bounceIn 0.5s ease-out; box-shadow: 0 25px 70px rgba(0,0,0,0.4); border: 3px solid var(--vodafone-red); position: relative; margin: auto; }
        .result-title { background: linear-gradient(135deg, var(--vodafone-red), var(--vodafone-dark)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-size: 1.4em; margin-bottom: 8px; font-weight: 800; }
        .prize-name { font-size: 1.2em; color: var(--vodafone-red); font-weight: 800; margin: 8px 0; line-height: 1.3; }
        .prize-icon { font-size: 2.5em; margin: 8px 0; }
        .discount-code { background: linear-gradient(135deg, var(--vodafone-red), var(--vodafone-dark)); color: white; padding: 10px 15px; border-radius: 12px; font-size: 1em; font-weight: 800; letter-spacing: 2px; margin: 10px 0; box-shadow: 0 6px 20px rgba(230,0,0,0.4); }
        .code-label { font-size: 0.75em; color: #666; margin-bottom: 6px; font-weight: 600; }
        .instructions { color: #555; font-size: 0.7em; margin-top: 10px; line-height: 1.5; }
        .close-button { background: linear-gradient(135deg, var(--vodafone-red), var(--vodafone-dark)); color: white; border: none; padding: 10px 25px; border-radius: 25px; font-size: 0.9em; cursor: pointer; margin-top: 12px; transition: transform 0.2s ease; font-weight: 800; box-shadow: 0 6px 20px rgba(230,0,0,0.4); }
        .close-button:active { transform: scale(0.95); }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideIn { from { opacity: 0; transform: translateX(30px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes bounceIn { 0% { transform: scale(0.5); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
        .confetti { position: fixed; width: 10px; height: 10px; position: absolute; will-change: transform; pointer-events: none; z-index: 999; }
        @media (max-width: 480px) {
            body { padding: 10px; }
            .landing-logo h1 { font-size: 2em; }
            .landing-logo { padding: 30px 40px; }
            .welcome-title { font-size: 2em; }
            .welcome-message { padding: 35px 25px; }
            .benefits { grid-template-columns: 1fr; gap: 15px; }
            .play-button { padding: 20px 45px; font-size: 1.4em; }
            .wheel-container { width: 300px; height: 300px; }
            .wheel-center { width: 80px; height: 80px; }
            .segment-text { font-size: 0.65em; width: 65px; }
            .result-content { max-width: 95%; padding: 20px 15px; border-radius: 15px; max-height: 90vh; }
            .result-title { font-size: 1.2em; }
            .prize-icon { font-size: 2em; }
            .prize-name { font-size: 1.1em; }
            .discount-code { font-size: 0.9em; padding: 8px 12px; }
            .code-label { font-size: 0.7em; }
            .instructions { font-size: 0.65em; }
            .close-button { padding: 8px 20px; font-size: 0.85em; }
        }
        @supports (-webkit-touch-callout: none) { body { min-height: -webkit-fill-available; } .wheel { -webkit-transform: translateZ(0); } }
    </style>
</head>
<body>
    <div class="landing-page" id="landingPage">
        <div class="landing-logo">
            <h1>Vodafone</h1>
            <p class="landing-subtitle">Il tuo negozio autorizzato</p>
        </div>
        <div class="welcome-message">
            <h2 class="welcome-title">🎯 Vinci con Vodafone!</h2>
            <p class="welcome-text">Gira la ruota della fortuna e <strong>vinci incredibili premi</strong>! Oggi è il tuo giorno fortunato!</p>
            <div class="benefits">
                <div class="benefit-item"><div class="benefit-icon">🎁</div><div class="benefit-text">2 Canoni Gratis</div></div>
                <div class="benefit-item"><div class="benefit-icon">⚡</div><div class="benefit-text">Sconto 100% Energia</div></div>
                <div class="benefit-item"><div class="benefit-icon">🎧</div><div class="benefit-text">Accessori Omaggio</div></div>
                <div class="benefit-item"><div class="benefit-icon">🎯</div><div class="benefit-text">Prendi 2 Paghi 1</div></div>
                <div class="benefit-item"><div class="benefit-icon">📡</div><div class="benefit-text">Extender Gratis</div></div>
            </div>
            <button class="play-button" onclick="startGame()" id="playButton">🎮 Gioca Ora</button>
        </div>
        <div class="cooldown-message" id="cooldownMessage" style="display: none;">
            <div class="cooldown-title">⏰ Hai già giocato oggi!</div>
            <div class="cooldown-text">Potrai giocare di nuovo tra:</div>
            <div class="cooldown-timer">
                <div class="timer-label">Prossima giocata disponibile tra:</div>
                <div class="timer-value" id="timerDisplay">--:--:--</div>
            </div>
        </div>
        <p class="disclaimer">* Una giocata gratuita al giorno per cliente. Premi validi solo presso il nostro punto vendita autorizzato.</p>
    </div>
    <div class="game-page" id="gamePage">
        <div class="game-header">
            <div class="game-logo"><h2 class="game-logo-title">Vodafone</h2></div>
            <h1 class="game-title">Ruota della Fortuna!</h1>
            <p class="game-subtitle">Scopri il tuo premio speciale 🎁</p>
        </div>
        <div class="wheel-container">
            <div class="wheel-shadow"></div>
            <div class="pointer">
                <svg viewBox="0 0 50 50" xmlns="http://www.w3.org/2000/svg">
                    <defs><linearGradient id="pointerGrad" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#FFD700;stop-opacity:1" /><stop offset="100%" style="stop-color:#FFA500;stop-opacity:1" /></linearGradient></defs>
                    <path d="M 25 5 L 35 25 L 25 20 L 15 25 Z" fill="url(#pointerGrad)" stroke="#8B6914" stroke-width="2"/>
                    <circle cx="25" cy="25" r="8" fill="#E60000" stroke="#FFD700" stroke-width="2"/>
                    <text x="25" y="30" text-anchor="middle" font-size="14" fill="white" font-weight="bold">↓</text>
                </svg>
            </div>
            <div class="wheel" id="wheel">
                <div class="wheel-base"></div>
                <div class="wheel-ring wheel-ring-outer"></div>
                <div class="wheel-segments" id="wheelSegments"></div>
                <div class="wheel-ring wheel-ring-inner"></div>
            </div>
            <div class="wheel-center">
                <button class="spin-button" id="spinButton"><span class="spin-icon">🎰</span><span>GIRA!</span></button>
            </div>
        </div>
        <button class="back-button" onclick="backToLanding()">← Torna alla home</button>
    </div>
    <div class="result-modal" id="resultModal">
        <div class="result-content">
            <h2 class="result-title">🎉 CONGRATULAZIONI! 🎉</h2>
            <div class="prize-icon" id="prizeIcon">🎯</div>
            <p style="font-size: 1em; font-weight: 600; color: #666; margin: 8px 0;">Hai vinto:</p>
            <div class="prize-name" id="prizeName">Prendi 2 Paghi 1!</div>
            <p class="code-label">Mostra questo codice al nostro staff:</p>
            <div class="discount-code" id="discountCode">VF2025XXXX</div>
            <p class="instructions" id="instructions"></p>
            <button class="close-button" onclick="closeModal()">Fantastico! 🚀</button>
        </div>
    </div>
    <script>
        let isSpinning=false,currentRotation=0;const GOOGLE_SCRIPT_URL='INSERISCI_QUI_URL_SCRIPT_GOOGLE',SHOP_NAME='Vodafone Via Roma Milano';
        const wheel=document.getElementById('wheel'),spinButton=document.getElementById('spinButton'),resultModal=document.getElementById('resultModal'),prizeName=document.getElementById('prizeName'),prizeIcon=document.getElementById('prizeIcon'),discountCode=document.getElementById('discountCode'),instructions=document.getElementById('instructions'),landingPage=document.getElementById('landingPage'),gamePage=document.getElementById('gamePage'),wheelSegments=document.getElementById('wheelSegments'),playButton=document.getElementById('playButton'),cooldownMessage=document.getElementById('cooldownMessage'),timerDisplay=document.getElementById('timerDisplay');
        let cooldownTimer=null;
        const prizes=[{name:'2 Canoni Gratis!',icon:'🎁',description:'I primi 2 mesi sono completamente gratuiti',segment:'2 CANONI<br>GRATIS',targetAngle:0},{name:'Sconto 100% Canone Fisso Energia!',icon:'⚡',description:'Sconto del 100% sul canone fisso energia per 6 mesi',segment:'SCONTO<br>100%<br>ENERGIA',targetAngle:288},{name:'Accessori Omaggio!',icon:'🎧',description:'Accessori premium in omaggio con la tua offerta',segment:'ACCESS.<br>OMAGGIO',targetAngle:216},{name:'Prendi 2 Paghi 1!',icon:'🎯',description:'Attiva 2 linee e paghi solo una per 12 mesi',segment:'PRENDI 2<br>PAGHI 1',targetAngle:144},{name:'Extender Gratis!',icon:'📡',description:'Wi-Fi Extender per ampliare la copertura in casa',segment:'EXTENDER<br>GRATIS',targetAngle:72}];
        function createWheelSegments(){wheelSegments.innerHTML='';prizes.forEach((p,i)=>{const s=document.createElement('div');s.className='segment';const t=document.createElement('div');t.className='segment-text';t.innerHTML=p.segment;s.appendChild(t);wheelSegments.appendChild(s);})}
        function canPlay(){try{const l=localStorage.getItem('vodafone_last_play_prendi2');if(!l)return true;const n=Date.now(),p=parseInt(l,10);if(isNaN(p)){localStorage.removeItem('vodafone_last_play_prendi2');return true;}return n-p>=86400000;}catch(e){return true;}}
        function getTimeUntilNextPlay(){try{const l=localStorage.getItem('vodafone_last_play_prendi2');if(!l)return 0;const n=Date.now(),p=parseInt(l,10);if(isNaN(p))return 0;return Math.max(0,p+86400000-n);}catch(e){return 0;}}
        function formatTimeRemaining(ms){const t=Math.floor(ms/1000),h=Math.floor(t/3600),m=Math.floor((t%3600)/60),s=t%60;return`${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;}
        function updateCooldownDisplay(){if(canPlay()){playButton.disabled=false;cooldownMessage.style.display='none';if(cooldownTimer){clearInterval(cooldownTimer);cooldownTimer=null;}return;}playButton.disabled=true;cooldownMessage.style.display='block';const r=getTimeUntilNextPlay();timerDisplay.textContent=formatTimeRemaining(r);if(!cooldownTimer){cooldownTimer=setInterval(()=>{if(canPlay()){updateCooldownDisplay();}else{timerDisplay.textContent=formatTimeRemaining(getTimeUntilNextPlay());}},1000);}}
        function setLastPlayTime(){try{localStorage.setItem('vodafone_last_play_prendi2',Date.now().toString());}catch(e){}}
        function startGame(){if(!canPlay()){updateCooldownDisplay();setTimeout(()=>cooldownMessage.scrollIntoView({behavior:'smooth',block:'center'}),100);return;}landingPage.style.display='none';gamePage.style.display='block';createWheelSegments();wheel.style.transition='none';wheel.style.transform='rotate(0deg) translateZ(0)';wheel.style.webkitTransform='rotate(0deg) translateZ(0)';currentRotation=0;void wheel.offsetWidth;requestAnimationFrame(()=>{requestAnimationFrame(()=>{wheel.style.transition='transform 5s cubic-bezier(0.17, 0.67, 0.12, 0.99)';wheel.style.webkitTransition='-webkit-transform 5s cubic-bezier(0.17, 0.67, 0.12, 0.99)';});});}
        function backToLanding(){gamePage.style.display='none';landingPage.style.display='block';resetWheel();}
        function resetWheel(){wheel.style.transition='none';wheel.style.webkitTransition='none';wheel.style.transform='rotate(0deg) translateZ(0)';wheel.style.webkitTransform='rotate(0deg) translateZ(0)';currentRotation=0;setTimeout(()=>{wheel.style.transition='transform 5s cubic-bezier(0.17, 0.67, 0.12, 0.99)';wheel.style.webkitTransition='-webkit-transform 5s cubic-bezier(0.17, 0.67, 0.12, 0.99)';},100);}
        function generateCode(){const l='ABCDEFGHIJKLMNOPQRSTUVWXYZ',n='0123456789',y=new Date().getFullYear();let c='VF'+y;for(let i=0;i<4;i++){c+=Math.random()>0.5?l.charAt(Math.floor(Math.random()*l.length)):n.charAt(Math.floor(Math.random()*n.length));}return c;}
        function getExpiryDate(){const e=new Date();e.setDate(e.getDate()+30);return`${String(e.getDate()).padStart(2,'0')}/${String(e.getMonth()+1).padStart(2,'0')}/${e.getFullYear()}`;}
        async function trackSpin(p,c){try{let sc=parseInt(localStorage.getItem('vodafone_spin_count_prendi2')||'0',10)+1;localStorage.setItem('vodafone_spin_count_prendi2',sc.toString());localStorage.setItem('vodafone_last_spin_prendi2',new Date().toISOString());const d={shop:SHOP_NAME,prize:p.name,code:c,device:/Mobile|Android|iPhone|iPad|iPod/i.test(navigator.userAgent)?'Mobile':'Desktop',browser:navigator.userAgent,count:sc,timestamp:new Date().toISOString()};if(GOOGLE_SCRIPT_URL&&GOOGLE_SCRIPT_URL!=='INSERISCI_QUI_URL_SCRIPT_GOOGLE'){try{await fetch(GOOGLE_SCRIPT_URL,{method:'POST',mode:'no-cors',headers:{'Content-Type':'application/json'},body:JSON.stringify(d)});}catch(e){let b=JSON.parse(localStorage.getItem('vodafone_backup_prendi2')||'[]');b.push(d);localStorage.setItem('vodafone_backup_prendi2',JSON.stringify(b));}}}catch(e){}}
        function createConfetti(){const c=['#E60000','#FFFFFF','#FFD700','#FF3333'];for(let i=0;i<30;i++){setTimeout(()=>{const e=document.createElement('div');e.className='confetti';e.style.left=Math.random()*100+'%';e.style.width=e.style.height=(Math.random()*8+4)+'px';e.style.background=c[Math.floor(Math.random()*c.length)];e.style.animation=`confetti-fall ${Math.random()*2+2}s linear`;document.body.appendChild(e);setTimeout(()=>e.remove(),3000);},i*50);}}
        function spin(){if(isSpinning)return;setLastPlayTime();isSpinning=true;spinButton.querySelector('span:last-child').textContent='...';spinButton.disabled=true;if('vibrate' in navigator){navigator.vibrate(200);}const w=3,p=prizes[w],f=9+Math.floor(Math.random()*4),t=p.targetAngle,n=currentRotation%360,d=(t-n+360)%360,r=currentRotation+(f*360)+d;wheel.style.transform=`rotate(${r}deg) translateZ(0)`;wheel.style.webkitTransform=`rotate(${r}deg) translateZ(0)`;currentRotation=r;setTimeout(()=>{if('vibrate' in navigator){navigator.vibrate([100,50,100,50,200]);}const c=generateCode();prizeName.textContent=p.name;prizeIcon.textContent=p.icon;discountCode.textContent=c;instructions.innerHTML=`${p.description}<br><br><strong>⏰ Valido fino al ${getExpiryDate()}</strong><br><strong>📍 Solo presso i nostri punti vendita autorizzati Vodafone</strong><br><br><small>Non cumulabile con altre promozioni in corso</small>`;resultModal.style.display='flex';createConfetti();trackSpin(p,c);isSpinning=false;spinButton.querySelector('span:last-child').textContent='GIRA!';spinButton.disabled=false;},5300);}
        function closeModal(){resultModal.style.display='none';setTimeout(()=>{backToLanding();updateCooldownDisplay();},300);}
        spinButton.addEventListener('click',(e)=>{e.preventDefault();if(!isSpinning)spin();});
        spinButton.addEventListener('touchend',(e)=>{e.preventDefault();if(!isSpinning)spin();},{passive:false});
        document.addEventListener('keydown',(e)=>{if(e.key==='Enter'&&!isSpinning&&gamePage.style.display==='block'){spin();}if(e.key==='Escape'){if(resultModal.style.display==='flex'){closeModal();}else if(gamePage.style.display==='block'){backToLanding();}}});
        let lastTouchEnd=0;document.addEventListener('touchend',(e)=>{const n=Date.now();if(n-lastTouchEnd<=300){e.preventDefault();}lastTouchEnd=n;},{passive:false});
        const metaViewport=document.querySelector('meta[name=viewport]');if(metaViewport&&/iPhone|iPad|iPod/.test(navigator.userAgent)){metaViewport.setAttribute('content','width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover');}
        createWheelSegments();updateCooldownDisplay();window.addEventListener('orientationchange',()=>{setTimeout(()=>window.scrollTo(0,1),100);});
    </script>
</body>
</html>
